<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${menu.menuName} + ' - 배민'">메뉴 상세</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/menu-detail.css}">
</head>
<body>
    <div class="main-container" 
         th:attr="data-base-price=${menu.price}, data-store-id=${store.storeId}, data-menu-id=${menu.menuId}">
        <!-- 상단 헤더 -->
        <div class="menu-header">
            <div class="header-content">
                <button class="back-btn" th:onclick="'location.href=\'/api/store/' + ${store.storeId} + '\''">←</button>
                <div class="menu-title">
                    <div class="menu-name" th:text="${menu.menuName}">메뉴명</div>
                </div>
                <div class="header-actions">
                    <button class="action-btn">📤</button>
                    <button class="action-btn">🔍</button>
                </div>
            </div>
        </div>

        <!-- 메뉴 이미지 -->
        <img th:src="${menu.imageUrl}" th:alt="${menu.menuName}" class="menu-image">

        <!-- 가게 정보 -->
        <div class="store-info">
            <div class="store-name" th:text="${store.storeName}">테스트 가게</div>
            <div class="store-min-order" th:text="${'배달 최소주문금액 ₩' + #numbers.formatInteger(store.minimumPrice, 1, 'COMMA')}">배달 최소주문금액 ₩10,000</div>
        </div>

        <!-- 메뉴 정보 -->
        <div class="menu-info">
            <div class="menu-badges">
                <span class="badge badge-popular" th:if="${menu.isPopular != null and menu.isPopular}">인기</span>
                <span class="badge badge-recommended" th:if="${menu.isRecommended != null and menu.isRecommended}">사장님 추천</span>
            </div>
            <div class="menu-name-large" th:text="${menu.menuName}">메뉴명</div>
            <div class="menu-description" th:text="${menu.description}">메뉴 설명</div>
            <div class="menu-rating">
                <span class="stars">★★★★☆</span>
                <span class="review-link" th:text="${'메뉴 리뷰 ' + menu.reviewCount + '개 >'}">메뉴 리뷰 2개 ></span>
            </div>
            <div class="menu-price" th:text="${'₩' + #numbers.formatInteger(menu.price, 1, 'COMMA')}">₩13,900</div>
        </div>

        <!-- 옵션 선택 -->
        <div class="option-section" th:if="${not #lists.isEmpty(menu.options)}">
            <div class="section-title">메뉴 옵션</div>
            <div class="section-subtitle">원하는 옵션을 선택해주세요</div>
            
            <div th:each="option : ${menu.options}">
                <!-- 옵션 그룹 헤더 -->
                <div class="option-group">
                    <div class="option-group-header">
                        <span class="option-name" th:text="${option.optionName}">옵션명</span>
                        <span class="option-required" th:if="${option.isRequired}">필수 선택</span>
                    </div>
                    <div class="option-description" th:text="${option.description}" th:if="${option.description != ''}">옵션 설명</div>
                    
                    <!-- 옵션 값들 -->
                    <div class="option-values" th:if="${not #lists.isEmpty(option.optionValues)}">
                        <div th:each="optionValue : ${option.optionValues}" class="option-value-item" th:if="${optionValue.isAvailable}">
                            <div class="option-value-content">
                                <div class="option-value-info">
                                    <input th:if="${option.isMultiple}" 
                                           type="checkbox" 
                                           th:id="'optionValue-' + ${optionValue.optionValueId}" 
                                           th:name="'option-' + ${option.optionId}"
                                           th:value="${optionValue.optionValueId}"
                                           class="option-value-checkbox" 
                                           th:data-price="${optionValue.additionalPrice}"
                                           th:data-option-id="${option.optionId}"
                                           th:data-value-id="${optionValue.optionValueId}">
                                    <input th:unless="${option.isMultiple}" 
                                           type="radio" 
                                           th:id="'optionValue-' + ${optionValue.optionValueId}" 
                                           th:name="'option-' + ${option.optionId}"
                                           th:value="${optionValue.optionValueId}"
                                           class="option-value-radio" 
                                           th:data-price="${optionValue.additionalPrice}"
                                           th:data-option-id="${option.optionId}"
                                           th:data-value-id="${optionValue.optionValueId}"
                                           th:required="${option.isRequired}">
                                    <label th:for="'optionValue-' + ${optionValue.optionValueId}" class="option-value-label">
                                        <span class="option-value-name" th:text="${optionValue.optionValue}">옵션 값</span>
                                    </label>
                                </div>
                                <div class="option-value-price" 
                                     th:class="${optionValue.additionalPrice == 0 ? 'free' : ''}" 
                                     th:text="${optionValue.additionalPrice == 0 ? '무료' : '₩' + #numbers.formatInteger(optionValue.additionalPrice, 1, 'COMMA')}">₩500</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 수량 선택 -->
        <div class="quantity-section">
            <div class="section-title">수량</div>
            <div class="quantity-control">
                <button class="quantity-btn" onclick="decreaseQuantity()">-</button>
                <span id="quantity" class="quantity-display">1</span>
                <button class="quantity-btn" onclick="increaseQuantity()">+</button>
            </div>
        </div>

        <!-- 하단 여백 -->
        <div class="bottom-spacer"></div>
    </div>

    <!-- 장바구니 버튼 -->
    <div class="cart-section">
        <div class="cart-content">
            <div class="cart-info">
                <div class="min-order-label">배달 최소주문금액</div>
                <div class="min-order-price" th:text="${'₩' + #numbers.formatInteger(store.minimumPrice, 1, 'COMMA')}">₩10,000</div>
            </div>
            <button class="btn-cart" onclick="addToCart()">
                <span id="totalPrice" th:text="${'₩' + #numbers.formatInteger(menu.price, 1, 'COMMA')} + ' 담기'">₩13,900 담기</span>
            </button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script th:src="@{/js/menu-detail.js}"></script>
</body>
</html> 